# Парсер отзывов с Ozon

Этот проект представляет собой инструмент для автоматического сбора комментариев, которые оставляют пользователи под карточками товаров на маркетплейсе Ozon. Программа собирает данные о комментариях, включая их содержание, оценку, автора, дату и другую информацию, а затем сохраняет их в JSON-файлы для дальнейшего анализа.

## Возможности

- Парсинг отзывов с карточек товаров Ozon
- Сбор информации об авторе, дате, оценке, тексте отзыва, лайках и дизлайках
- Обработка пагинации и "Показать больше отзывов"
- Сохранение данных в JSON-файлы (отдельный файл для каждого товара)
- Поддержка обработки нескольких URL товаров
- Планировщик для регулярного сбора комментариев
- Гибкая настройка через файл конфигурации

## Требования

- Python 3.7+
- Playwright (и поддерживаемые браузеры)

## Установка

1. Клонируйте репозиторий:
```
git clone <URL репозитория>
cd ozon_review_parser
```

2. Установите зависимости:
```
pip install -r requirements.txt
playwright install
```

3. Настройте параметры в файле `.env` (при необходимости):
```
# Настройки парсера
HEADLESS=false
...
```

## Использование

### Парсинг отзывов по одному URL

```
python main.py --url https://www.ozon.ru/product/[название_товара]/[ID]
```

### Парсинг отзывов по списку URL из файла

1. Создайте файл со списком URL (например, `urls.txt`), по одному URL на строку:
```
https://www.ozon.ru/product/[товар1]/[ID1]
https://www.ozon.ru/product/[товар2]/[ID2]
```

2. Запустите парсер с параметром `--file`:
```
python main.py --file urls.txt
```

### Запуск по расписанию

1. Добавьте URL в файл `product_urls.txt` (создастся автоматически при первом запуске скрипта):
```
https://www.ozon.ru/product/[товар1]/[ID1]
https://www.ozon.ru/product/[товар2]/[ID2]
```

2. Запустите скрипт планировщика:
```
python scheduled_parser.py
```

3. Для автоматического запуска по расписанию добавьте задачу в cron:
```
# Запуск каждый день в 3 часа ночи
0 3 * * * /path/to/python3 /path/to/scheduled_parser.py
```

## Структура проекта

```
ozon_review_parser/
│
├── main.py                 # Основная точка входа
├── scheduled_parser.py     # Скрипт для запуска по расписанию
├── product_urls.txt        # Список URL товаров для регулярного парсинга
├── .env                    # Файл с переменными окружения
├── requirements.txt        # Зависимости проекта
│
├── src/                    # Исходный код
│   ├── parsers/            # Модули парсеров
│   │   └── ozon_review_parser.py  # Парсер отзывов Ozon
│   │
│   ├── database/           # Модули для работы с хранилищем данных
│   │   └── json_storage.py # Хранение данных в JSON-файлах
│   │
│   └── utils/              # Вспомогательные модули
│       ├── config.py       # Загрузка конфигурации
│       └── logger.py       # Логирование
│
├── logs/                   # Директория с логами
├── reviews_data/           # Директория с JSON-файлами отзывов (создается автоматически)
└── results/                # Директория с результатами парсинга
```

## Хранение данных

Отзывы о каждом товаре сохраняются в отдельный JSON-файл в директории `reviews_data/`. Имя файла формируется на основе ID товара, например: `reviews_12345678.json`. Эти файлы можно легко открыть любым текстовым редактором или программно обработать для анализа и визуализации данных.

## Особенности и ограничения

- Парсер учитывает особенности работы сайта Ozon, такие как "ленивая загрузка" (lazy loading) комментариев.
- Для защиты от блокировки добавлены случайные задержки между запросами.
- Максимальное количество отзывов для одного товара можно ограничить в файле `.env`.
- При изменении структуры сайта Ozon может потребоваться обновление селекторов в парсере.

## Лицензия

MIT

## Автор

Ваше имя / организация 